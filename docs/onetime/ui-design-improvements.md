# 過去の日報閲覧機能 - UIデザイン改善記録

## 概要
過去の日報閲覧機能のUIプロトタイプ実装における、デザイン改善の変遷と学んだ知見をまとめた記録。

## デザイン改善の変遷

### 1. 初期実装（タブ切り替え方式）
**実装内容:**
- Material-UIのTabsコンポーネント使用
- [今日の日報] [過去の日報] のタブ切り替え
- 過去の日報は縦長のListコンポーネントで表示

**問題点:**
- 縦に長いリスト表示で見にくい
- 画面スペースを大量消費
- 一覧性が悪い

**ユーザーフィードバック:**
> "表示はできてるけどさすがに見にくいな。プルダウンから選ぶとかが良くない。"

### 2. プルダウン形式
**実装内容:**
- Material-UIのSelectコンポーネント使用
- 「過去の日報を選択」プルダウン
- 各項目: "yyyy-MM-dd - タイトル (N個のつぶやき)" 形式

**改善点:**
- 画面の縦スペースを大幅に節約
- モバイルフレンドリーなネイティブプルダウン

**問題点:**
- PC・モバイル両方での操作性に課題
- 一覧性がさらに悪化

**ユーザーフィードバック:**
> "基本的にパソコンからも使うんだけど、iPhoneの小さいUIからも使うって感じだから、プルダウンでコンパクトに選択できる感じがいいな。"
> → さらに検討後: "あとサイドバー形式にしたいなそもそも"

### 3. 文字色の統一問題
**発生した問題:**
- タブやプルダウンの文字色が見にくい（暗いグレー系）
- 既存UIの白いテキストと色が合わない

**試行錯誤の過程:**
1. **具体的な色指定 (#ffffff)**
   ```tsx
   color: '#ffffff'
   ```
   
2. **ライブラリのテーマトークン使用要求**
   > "そうじゃない具体のやつじゃなくてテキストなんとかみたいな感じの他のと合わせる感じにしてほしいんだけど。primary.mainとか"
   
3. **Material-UIテーマトークン (text.primary)**
   ```tsx
   color: 'text.primary'
   ```
   
4. **再び見にくくなる問題**
   > "また見にくくなったじゃん"

**最終解決:**
- Material-UIテーマが完全なダークモード設定されていないため、`text.primary`が暗色になる
- App.cssの`color: white`に合わせて直接`'white'`指定で統一

### 4. サイドバー形式への変更
**実装内容:**
- 左サイドバー（280px幅）+ 右メインエリアの2ペイン構成
- デスクトップ: 常時サイドバー表示
- モバイル: Drawerコンポーネントでドロワー形式

**設計決定:**
```tsx
const SIDEBAR_WIDTH = 280;
const isMobile = useMediaQuery(theme.breakpoints.down('md'));
```

**改善点:**
- 直感的な操作性
- PC・モバイル両対応のレスポンシブ設計
- 一覧性と詳細表示の両立

### 5. モバイル用ハンバーガーメニュー
**初期実装:**
```tsx
<Button onClick={() => setSidebarOpen(true)}>
  日報一覧を開く
</Button>
```

**問題点:**
- テキストボタンでモバイルアプリらしくない

**改善要求:**
> "日報一覧を開くは左上のところにあのなんかボタンがぴょこって出てる感じのそういうサイドバーの開閉にしたいな。"

**最終実装:**
```tsx
import MenuIcon from '@mui/icons-material/Menu';

<IconButton
  sx={{ 
    position: 'fixed', 
    top: 16, 
    left: 16, 
    zIndex: 1000,
    backgroundColor: 'rgba(0, 0, 0, 0.5)'
  }}
>
  <MenuIcon />
</IconButton>
```

### 6. レイアウト調整
**問題:**
- ハンバーガーメニューとコンテンツ（特にタグ入力欄）の重なり

**解決:**
```tsx
sx={{ 
  pt: isMobile ? 4 : 2  // モバイルでの上部マージン調整
}}
```

**調整過程:**
- 初期: `pt: 8` → 上部スペースが空きすぎ
- 最終: `pt: 4` → 適切な間隔

### 7. サイドバー背景色
**問題:**
- Drawer開時の背景色が薄いグレーで見にくい

**解決:**
```tsx
bgcolor: '#1e1e1e'  // 濃いグレーで視認性向上
```

### 8. 情報表示の改善
**要求:**
- 日付、タイトル、タグ情報の表示
- 当初はサイドバーに実装したが変更要求

**ユーザーフィードバック:**
> "サイドバーじゃなくて本体の方に出してほしいのタグとタイトルとか"

**最終実装:**
- サイドバー: シンプルな日報リスト
- メインエリア: 詳細情報（日付、タイトル、タグ、投稿数）

```tsx
<Typography variant="h5">{selectedReport?.formattedDate}の日報</Typography>
<Typography variant="h6">{selectedReport?.title}</Typography>
<Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>
  {selectedReport?.tags.map(tag => <Chip key={tag} label={tag} />)}
</Box>
```

## 学んだデザイン原則

### 1. レスポンシブ対応の重要性
- PC・モバイル両方を最初から考慮する必要性
- `useMediaQuery`による適切な分岐処理

### 2. 色の統一性
- 既存UIとの一貫性が最優先
- テーマトークンが機能しない場合は直接指定も有効
- ダークテーマでは特に色の統一が重要

### 3. 情報階層の設計
- 一覧表示（サイドバー）と詳細表示（メイン）の役割分担
- 詳細情報は適切な場所に配置する

### 4. 操作性の原則
- モバイルでは標準的なUI（ハンバーガーメニュー等）を使用
- 固定配置要素は他の要素との重なりに注意

### 5. 段階的改善の有効性
- プロトタイプ → フィードバック → 改善のサイクル
- ユーザーの直感的な要求を技術的に実現する

## 技術的な学び

### Material-UIでのダークテーマ対応
```tsx
// テーマトークンが期待通りに動作しない場合
color: 'text.primary'  // ❌ ライトテーマの色になる場合がある
color: 'white'         // ✅ 確実にダークテーマに合う

// 背景色の工夫
bgcolor: 'rgba(0, 0, 0, 0.2)'  // ❌ 薄すぎて見にくい
bgcolor: '#1e1e1e'             // ✅ 適切なコントラスト
```

### レスポンシブレイアウト
```tsx
// デスクトップ・モバイルの分岐
const isMobile = useMediaQuery(theme.breakpoints.down('md'));

// 条件付きスタイル
sx={{ pt: isMobile ? 4 : 2 }}

// 条件付きコンポーネント表示
{!isMobile && <PermanentSidebar />}
{isMobile && <DrawerSidebar />}
```

## 今後の改善案

### 1. パフォーマンス最適化
- React.memoによる再レンダリング防止
- 日報データのキャッシュ機能

### 2. UX改善
- 日報間の遷移アニメーション
- ローディング状態の改善

### 3. アクセシビリティ
- キーボードナビゲーション対応
- スクリーンリーダー対応

## 参考資料
- [Material-UI Drawer](https://mui.com/material-ui/react-drawer/)
- [Material-UI useMediaQuery](https://mui.com/material-ui/react-use-media-query/)
- [過去の日報閲覧機能 実装計画](./past-daily-reports-feature-plan.md)